-- 1) В базе данных shop и sample присутствуют одни и те же таблицы, учебной базы данных. Переместите запись id = 1 из таблицы shop.users в таблицу sample.users. Используйте транзакции.

START TRANSACTION;
INSERT INTO sample.users
  SELECT  -- будем добавлять в таблицу на последнее место
	  ((SELECT MAX(id) FROM sample.users)+1), -- находим на какое место добавлять
	  `name`,
	  birthday_at,
	  created_at,
	  updated_at
  FROM shop.users
  WHERE id = 1;
DELETE FROM shop.users WHERE id=1;
COMMIT;


-- 2) Создайте представление, которое выводит название name товарной позиции из таблицы products и соответствующее название каталога name из таблицы catalogs.

CREATE OR REPLACE VIEW task_2 AS
SELECT 
	shop.products.`name`,
	shop.catalogs.`name` as `catalog_name`
FROM shop.products
JOIN shop.catalogs ON shop.catalogs.id = shop.products.catalog_id;

-- SHOW TABLES FROM shop; -- можем увидеть представление как таблицу 
-- SELECT * FROM task_2; -- можем обратиться как к таблице


-- 1) Администрирование MySQL. Создайте двух пользователей которые имеют доступ к базе данных shop. Первому пользователю shop_read должны быть доступны только запросы на чтение данных, второму пользователю shop — любые операции в пределах базы данных shop.

CREATE USER 'shop_read'@'localhost' IDENTIFIED WITH sha256_password BY 'password';  -- зададим пассворд
GRANT SELECT ON shop.* TO 'shop_read'@'localhost';

CREATE USER 'shop'@'localhost' IDENTIFIED WITH sha256_password BY 'password';
GRANT ALL ON shop.* TO 'shop'@'localhost';
